@page "/talon-import"
@using DataAccessLibrary.Services
@inject TalonVoiceCommandDataService TalonServiceField

<div class="container mt-4">
    <h2>Import Talon Scripts</h2>
    <p>Import .talon files into the database for semantic search and management.</p>
    <div class="mb-3">
        <InputFile class="form-control" OnChange="OnFileSelected" multiple accept=".talon" aria-label="Select Talon files" />
    </div>
    <button class="btn btn-primary" @onclick="ImportFiles" disabled="@(SelectedFiles == null || !SelectedFiles.Any())" aria-label="Import">Import</button>
    <button class="btn btn-secondary ms-2" @onclick="ImportAllFromDirectory" aria-label="Import All">Import All from Directory</button>
    <div class="mt-3">
        @if (IsLoading)
        {
            <div class="spinner-border" role="status" aria-label="Importing"></div>
            @if (ImportTotal > 0)
            {
                <div class="progress mt-2" style="height: 24px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" style="width: @(ImportProgress * 100 / ImportTotal)%" aria-valuenow="@ImportProgress" aria-valuemin="0" aria-valuemax="@ImportTotal">
                        @ImportProgress / @ImportTotal
                    </div>
                </div>
            }
        }
        else if (!string.IsNullOrEmpty(ImportResult))
        {
            <div class="alert alert-success" role="alert">
                @ImportResult
            </div>
        }
        else if (!string.IsNullOrEmpty(ErrorMessage))
        {
            <div class="alert alert-danger" role="alert">
                @ErrorMessage
            </div>
        }
    </div>
    <div class="mb-3 mt-3">
        <input class="form-control" type="text" @bind="DirectoryPath" placeholder="Directory to import all .talon files from..." aria-label="Directory path" />
    </div>
</div>
